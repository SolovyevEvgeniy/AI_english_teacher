# English Practice Telegram Bot

Telegram бот для практики английского языка с помощью голосовых сообщений. Бот использует технологии распознавания и синтеза речи, проверяет грамматику и поддерживает диалог на английском языке.

## Основные возможности

- Обработка голосовых сообщений на английском языке
- Распознавание речи (Speech-to-Text)
- Проверка грамматики английского языка
- Интеллектуальные ответы с использованием HuggingFace API
- Озвучивание ответов (Text-to-Speech)
- Поддержка контекста разговора

## Структура проекта

```
├── services/
│   ├── chat_handler.py      # Обработка диалога и API запросов
│   └── speech_handler.py    # Работа с голосом (STT и TTS)
├── utils/
│   └── audio_converter.py   # Конвертация аудио форматов
├── temp_audio/             # Временные аудио файлы
├── temp_voice/             # Временные голосовые сообщения
├── bot.py                  # Основной файл бота
└── config.py              # Конфигурация и настройки
```

## Требования

- Python 3.8 или выше
- Telegram Bot Token
- HuggingFace API Token

### Зависимости

```bash
aiofiles     # для асинхронной работы с файлами
aiohttp      # для асинхронных HTTP запросов
gtts         # для преобразования текста в речь
pydub        # для работы с аудио файлами
pytelegrambotapi  # для работы с Telegram API
speechrecognition  # для распознавания речи
```

## Установка и настройка

1. Клонируйте репозиторий:
```bash
git clone [URL репозитория]
cd [название папки]
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Создайте и настройте переменные окружения:
```bash
export TELEGRAM_TOKEN='ваш_токен_телеграм'
export HUGGINGFACE_API_TOKEN='ваш_токен_huggingface'
```

4. Запустите бота:
```bash
python bot.py
```

## Использование бота

### Доступные команды

- `/start` - Начать разговор с ботом
- `/help` - Показать список доступных команд
- `/reset` - Сбросить историю разговора

### Процесс работы

1. Отправьте боту голосовое сообщение на английском языке
2. Бот преобразует ваше сообщение в текст и покажет его вам
3. Проверит грамматику и, если найдет ошибки:
   - Укажет на конкретные ошибки
   - Предложит правильный вариант
   - Объяснит правило грамматики
4. Сгенерирует осмысленный ответ на ваше сообщение
5. Отправит ответ в виде текста и голосового сообщения

### Примеры взаимодействия

#### Пример 1: Простой диалог
```
Вы: [голосовое сообщение] "How are you today?"
Бот: You said: "How are you today?"
     Grammar: Perfect!
     I'm doing great, thank you for asking! How about you?
     [голосовое сообщение с ответом]
```

#### Пример 2: Исправление грамматики
```
Вы: [голосовое сообщение] "I go to school yesterday"
Бот: You said: "I go to school yesterday"
     Grammar: Ошибка в использовании времени:
     - "I go" -> "I went" (Past Simple для действий в прошлом)
     I went to school yesterday. What did you study there?
     [голосовое сообщение с ответом]
```

## Особенности реализации

### Технические особенности
- Асинхронная обработка сообщений для быстрой работы
- Использование современных API и библиотек:
  - Speech-to-Text для распознавания речи
  - HuggingFace API для генерации ответов
  - Text-to-Speech для озвучивания
- Автоматическая очистка временных файлов

### Функциональные особенности
- Контекст разговора:
  - Хранение последних 2 обменов сообщениями
  - Поддержка связного диалога
  - Возможность сброса контекста
- Проверка грамматики:
  - Анализ грамматических конструкций
  - Подробные объяснения ошибок
  - Предложения по исправлению

### Обработка ошибок
- Понятные сообщения при проблемах с распознаванием
- Защита от слишком частых запросов (rate limiting)
- Автоматическое восстановление при сбоях

## Поддержка и решение проблем

При возникновении проблем:
1. Проверьте правильность установки всех зависимостей
2. Убедитесь в корректности токенов API
3. Проверьте доступ к интернету и API сервисам
4. Просмотрите логи бота для диагностики

## Примечания

- Временные файлы голосовых сообщений автоматически удаляются
- Между запросами к API соблюдается пауза в 2 секунды
- История разговора ограничена последними 2 обменами
